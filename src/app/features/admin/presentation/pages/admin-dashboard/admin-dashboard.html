<div class="p-6 space-y-6">
    <!-- Header -->
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <div>
            <h2 class="text-2xl font-bold text-gray-800">Dashboard Institucional</h2>
            <p class="text-gray-500">Gestión global de la plataforma tecnológica universitaria.</p>
        </div>
        <div class="flex items-center gap-3">
            <div class="px-4 py-2 bg-white border border-gray-200 rounded-lg text-gray-700 text-sm font-medium shadow-sm flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 text-gray-500">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
                </svg>
                <span>Enero {{now}}</span>
            </div>
        </div>
    </div>

    <!-- Stats Grid -->
    @if (dashboardData$ | async; as data) {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        @for (stat of data.stats; track stat.label) {
        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden group">
            <div class="relative z-10">
                <div class="flex items-start justify-between mb-4">
                    <span class="text-gray-500 font-medium text-xs tracking-wider uppercase">{{stat.label}}</span>
                    <div class="p-2 rounded-lg" [ngClass]="{
                        'bg-blue-50 text-blue-600': stat.icon === 'users',
                        'bg-purple-50 text-purple-600': stat.icon === 'chalkboard-teacher',
                        'bg-teal-50 text-teal-600': stat.icon === 'book',
                        'bg-orange-50 text-orange-600': stat.icon === 'university'
                    }">
                        <!-- Icon Switching -->
                        @if (stat.icon === 'users') {
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
                            </svg>
                        } @else if (stat.icon === 'chalkboard-teacher') {
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.499 5.216 50.552 50.552 0 00-2.658.814m-15.482 0A50.55 50.55 0 0112 13.489a50.55 50.55 0 0110.499-3.342" />
                            </svg>
                        } @else if (stat.icon === 'book') {
                             <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
                            </svg>
                        } @else if (stat.icon === 'university') {
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 21v-8.25M15.75 21v-8.25M8.25 21v-8.25M3 9l9-6 9 6m-1.5 12V10.332A48.36 48.36 0 0012 9.75c-2.551 0-5.056.2-7.5.582V21M3 21h18M12 6.75h.008v.008H12V6.75z" />
                            </svg>
                        }
                    </div>
                </div>
                <div class="flex items-baseline gap-3 mb-1">
                    <span class="text-3xl font-bold text-gray-900">{{stat.value}}</span>
                     <span [class]="stat.trendType === 'positive' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700' + ' px-2 py-0.5 rounded text-xs font-bold'">
                        {{stat.trend}}
                     </span>
                </div>
                <p class="text-sm text-gray-500">{{stat.description}}</p>
            </div>
        </div>
        }
    </div>

    <!-- Stats Grid (Chart + System Status) -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <!-- Growth Chart (Mock) -->
        <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col h-[400px]">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-bold text-gray-800">Crecimiento Institucional</h3>
                <div class="flex items-center gap-4 text-sm">
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full bg-blue-500"></span>
                        <span class="text-gray-600">{{now}}</span>
                    </div>
                </div>
            </div>
            
             <!-- Chart Container -->
             <div class="flex-1 flex items-end justify-between gap-4 px-4 pb-2 border-b border-gray-200 relative">
                 <!-- Grid Lines -->
                 <div class="absolute inset-0 flex flex-col justify-between pointer-events-none text-xs text-gray-300 z-0">
                     <div class="border-t border-gray-100 w-full h-0"></div>
                     <div class="border-t border-gray-100 w-full h-0"></div>
                     <div class="border-t border-gray-100 w-full h-0"></div>
                     <div class="border-t border-gray-100 w-full h-0"></div>
                 </div>

                 <!-- Bars -->
                 <div class="flex flex-col items-center gap-2 group w-full z-10">
                     <div class="w-full bg-blue-100 rounded-t-sm h-[40%] group-hover:bg-blue-200 transition-colors relative">
                        <div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity">120</div>
                     </div>
                     <span class="text-xs text-gray-400 font-medium">Ene</span>
                 </div>
                 <div class="flex flex-col items-center gap-2 group w-full z-10">
                     <div class="w-full bg-blue-100 rounded-t-sm h-[55%] group-hover:bg-blue-200 transition-colors relative">
                         <div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity">165</div>
                     </div>
                     <span class="text-xs text-gray-400 font-medium">Feb</span>
                 </div>
                 <div class="flex flex-col items-center gap-2 group w-full z-10">
                     <div class="w-full bg-blue-100 rounded-t-sm h-[70%] group-hover:bg-blue-200 transition-colors relative">
                         <div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity">210</div>
                     </div>
                     <span class="text-xs text-gray-400 font-medium">Mar</span>
                 </div>
                 <div class="flex flex-col items-center gap-2 group w-full z-10">
                     <div class="w-full bg-blue-500 rounded-t-sm h-[85%] group-hover:bg-blue-600 transition-colors relative shadow-lg shadow-blue-200">
                         <div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity">255</div>
                     </div>
                     <span class="text-xs text-gray-800 font-bold">Abr</span>
                 </div>
                 <div class="flex flex-col items-center gap-2 group w-full z-10">
                     <div class="w-full bg-blue-50 rounded-t-sm h-[88%] group-hover:bg-blue-100 transition-colors relative border-dashed border-2 border-blue-200">
                          <div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity">280 (Est)</div>
                     </div>
                     <span class="text-xs text-gray-400 font-medium">May</span>
                 </div>
                 <div class="flex flex-col items-center gap-2 group w-full z-10">
                     <div class="w-full bg-gray-50 rounded-t-sm h-[30%] relative"></div>
                     <span class="text-xs text-gray-300 font-medium">Jun</span>
                 </div>
             </div>
        </div>

        <!-- System Status -->
        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
             <div class="flex items-center justify-between mb-6">
                 <h3 class="font-bold text-lg text-gray-800">Estado del Sistema</h3>
                 <span class="bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-bold uppercase tracking-wide">Operativo</span>
             </div>
             <div class="space-y-4">
                @for (status of data.systemStatus; track status.title) {
                <div [ngClass]="{
                    'bg-red-50 border-red-100': status.type === 'error',
                    'bg-blue-50 border-blue-100': status.type === 'info',
                    'bg-yellow-50 border-yellow-100': status.type === 'warning'
                }" class="p-4 rounded-lg border">
                    <div class="flex gap-3">
                         <div [ngClass]="{
                            'text-red-500': status.type === 'error',
                            'text-blue-500': status.type === 'info',
                            'text-yellow-500': status.type === 'warning'
                        }" class="mt-0.5">
                            @if (status.type === 'error') {
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" />
                                </svg>
                            } @else if (status.type === 'info') {
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
                                </svg>
                            } @else {
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.008v.008H12v-.008z" />
                                </svg>
                            }
                         </div>
                         <div>
                             <h4 class="font-bold text-sm text-gray-900">{{status.title}}</h4>
                             <p class="text-xs text-gray-600 mt-1">{{status.message}}</p>
                         </div>
                    </div>
                </div>
                }
             </div>

        </div>
    </div>

    <!-- Recent Activity -->
    <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
        <div class="flex items-center justify-between mb-6">
            <h3 class="font-bold text-lg text-gray-800">Actividad Reciente del Sistema</h3>
        </div>
        <div class="space-y-6">
            @for (activity of data.recentActivity; track activity.title) {
            <div class="flex items-start gap-4">
                 <div class="mt-1 w-2 h-2 rounded-full bg-blue-500 flex-shrink-0"></div>
                 <div class="flex-1">
                     <h4 class="text-sm font-bold text-gray-900">{{activity.title}}</h4>
                     <p class="text-sm text-gray-600 mt-0.5">{{activity.description}}</p>
                     <p class="text-xs text-gray-400 mt-1 uppercase font-medium tracking-wide">{{activity.time}}</p>
                 </div>
            </div>
            }
        </div>
    </div>
    }
</div>
