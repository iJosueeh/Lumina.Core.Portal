<!-- Course Detail Page - Unified View -->
<div class="min-h-screen bg-gradient-to-br from-[#0a1628] via-[#0f1e33] to-[#1a2942]">
  @if (course && course.id) {
    <!-- Hero Header -->
    <header class="relative h-64 bg-gradient-to-r from-gray-900 to-gray-800 overflow-hidden">
      <!-- ... contenido del header ... -->
      <img
        [src]="course.coverImage"
        alt="Course cover"
        class="absolute inset-0 w-full h-full object-cover opacity-30"
      />
      <div class="relative h-full flex items-end p-8">
        <div class="flex items-center gap-4 text-white">
          <button class="p-2 hover:bg-white/10 rounded-lg transition-colors" aria-label="Volver">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15.75 19.5L8.25 12l7.5-7.5"
              />
            </svg>
          </button>
          <div>
            <div class="flex items-center gap-2 mb-2">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-5 h-5"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5zm0 0v-3.675A55.378 55.378 0 0112 8.443m-7.007 11.55A5.981 5.981 0 006.75 15.75v-1.5"
                />
              </svg>
              <span class="text-sm">{{ course.semester }}</span>
            </div>
            <h1 class="text-3xl font-bold mb-2">{{ course.title }}</h1>
            <div class="flex items-center gap-3">
              <img [src]="course.instructor.avatar" alt="Instructor" class="w-8 h-8 rounded-full" />
              <div class="text-sm">
                <p class="font-semibold">Prof. {{ course.instructor.name }}</p>
                <p class="text-gray-300">{{ course.instructor.title }}</p>
              </div>
              <button
                (click)="continueCurrentLesson()"
                class="ml-4 px-4 py-2 bg-teal-500 hover:bg-teal-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-teal-500/20 transition-all duration-300 flex items-center gap-2"
              >
                <span>Continuar Lección</span>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                  class="w-4 h-4"
                >
                  <path
                    fill-rule="evenodd"
                    d="M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z"
                    clip-rule="evenodd"
                  />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content Grid -->
    <main class="container mx-auto px-4 py-8 grid grid-cols-12 gap-8">
      <!-- Left Column: Content (8 cols) -->
      <div class="col-span-12 lg:col-span-8 space-y-8">
        <!-- Tabs Navigation -->
        <nav class="flex items-center gap-2 p-1 bg-navy-800/50 rounded-xl overflow-x-auto">
          @for (tab of tabs; track tab.id) {
            <button
              (click)="setTab(tab.id)"
              [class.bg-teal-500]="activeTab === tab.id"
              [class.text-white]="activeTab === tab.id"
              [class.text-gray-400]="activeTab !== tab.id"
              [class.hover:bg-white/5]="activeTab !== tab.id"
              class="flex items-center gap-2 px-4 py-2 rounded-lg transition-all duration-200 whitespace-nowrap"
            >
              <!-- Icon Injection -->
              @switch (tab.icon) {
                @case ('document') {
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"
                    />
                  </svg>
                }
                @case ('book') {
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"
                    />
                  </svg>
                }
                @case ('folder') {
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z"
                    />
                  </svg>
                }
                @case ('chart') {
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-5 h-5"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"
                    />
                  </svg>
                }
              }
              {{ tab.label }}
            </button>
          }
        </nav>

        <!-- Tab Content -->
        @switch (activeTab) {
          @case ('description') {
            <!-- Description Tab -->
            <div class="space-y-6 fade-in">
              <section class="bg-navy-800/50 p-6 rounded-xl border border-navy-700">
                <h2 class="text-xl font-bold text-white mb-4">Acerca del curso</h2>
                <p class="text-gray-300 leading-relaxed">{{ course.description }}</p>
              </section>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Learning Objectives -->
                <section class="bg-navy-800/50 p-6 rounded-xl border border-navy-700">
                  <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="1.5"
                      stroke="currentColor"
                      class="w-5 h-5 text-teal-400"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"
                      />
                    </svg>
                    Lo que aprenderás
                  </h3>
                  <ul class="space-y-3">
                    @for (item of course.learningObjectives; track $index) {
                      <li class="flex items-start gap-3 text-gray-300">
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke-width="1.5"
                          stroke="currentColor"
                          class="w-5 h-5 text-teal-500 mt-0.5"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M4.5 12.75l6 6 9-13.5"
                          />
                        </svg>
                        <span>{{ item }}</span>
                      </li>
                    }
                  </ul>
                </section>

                <!-- Requirements -->
                <section class="bg-navy-800/50 p-6 rounded-xl border border-navy-700">
                  <h3 class="text-lg font-semibold text-white mb-4 flex items-center gap-2">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="1.5"
                      stroke="currentColor"
                      class="w-5 h-5 text-orange-400"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"
                      />
                    </svg>
                    Requisitos
                  </h3>
                  <ul class="space-y-3">
                    @for (req of course.requirements; track $index) {
                      <li class="flex items-start gap-3 text-gray-300">
                        <span class="w-1.5 h-1.5 rounded-full bg-orange-400 mt-2.5"></span>
                        <span>{{ req }}</span>
                      </li>
                    }
                  </ul>
                </section>
              </div>
            </div>
          }
          @case ('content') {
            <!-- Content Tab (Modules) -->
            <div class="space-y-4 fade-in">
              @for (module of course.modules; track module.id) {
                <article class="gradient-border-card card-3d group">
                  <!-- Module Header (Clickable) -->
                  <button
                    (click)="toggleModule(module)"
                    class="w-full p-6 flex items-center gap-4 text-left hover:bg-white/5 transition-colors rounded-t-xl"
                    [attr.aria-expanded]="expandedModules.has(module.id)"
                    [attr.aria-controls]="'module-content-' + module.id"
                  >
                    <!-- Module Number -->
                    <div
                      class="w-10 h-10 rounded-full bg-navy-700 flex items-center justify-center text-teal-400 font-bold border border-navy-600 group-hover:border-teal-500/50 transition-colors"
                    >
                      {{ $index + 1 }}
                    </div>

                    <div class="flex-1">
                      <h3 class="text-white font-semibold flex items-center gap-3">
                        {{ module.title }}
                        @if (module.id === 'm1') {
                          <span
                            class="px-2 py-0.5 rounded text-xs font-medium bg-green-500/10 text-green-400"
                            >Completado</span
                          >
                        }
                      </h3>
                      <p class="text-sm text-gray-400 mt-1">{{ module.duration }} • 3 lecciones</p>
                    </div>

                    <!-- Chevron Icon -->
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="1.5"
                      stroke="currentColor"
                      class="w-5 h-5 text-gray-400 transition-transform duration-300"
                      [class.rotate-180]="expandedModules.has(module.id)"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M19.5 8.25l-7.5 7.5-7.5-7.5"
                      />
                    </svg>
                  </button>

                  <!-- Lessons List (Collapsible) -->
                  @if (expandedModules.has(module.id)) {
                    <div
                      [id]="'module-content-' + module.id"
                      class="border-t border-navy-700/50 bg-black/20"
                    >
                      <ul class="divide-y divide-navy-700/30">
                        @for (lesson of module.lessons; track lesson.id) {
                          <li>
                            <div
                              class="p-4 flex items-center gap-4 hover:bg-white/5 transition-colors group/lesson cursor-pointer"
                              (click)="startLesson(lesson)"
                            >
                              <!-- Status Icon -->
                              <div class="flex-shrink-0">
                                @if (lesson.isCompleted) {
                                  <svg
                                    class="w-6 h-6 text-teal-500"
                                    fill="currentColor"
                                    viewBox="0 0 24 24"
                                  >
                                    <path
                                      fill-rule="evenodd"
                                      d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z"
                                      clip-rule="evenodd"
                                    />
                                  </svg>
                                } @else if (lesson.isLocked) {
                                  <svg
                                    class="w-6 h-6 text-gray-600"
                                    fill="none"
                                    stroke="currentColor"
                                    viewBox="0 0 24 24"
                                  >
                                    <path
                                      stroke-linecap="round"
                                      stroke-linejoin="round"
                                      stroke-width="1.5"
                                      d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"
                                    />
                                  </svg>
                                } @else {
                                  <div
                                    class="w-6 h-6 rounded-full border-2 border-gray-500 group-hover/lesson:border-teal-400 transition-colors"
                                  ></div>
                                }
                              </div>

                              <div class="flex-1 min-w-0">
                                <p
                                  class="text-gray-200 group-hover/lesson:text-teal-400 transition-colors font-medium truncate"
                                >
                                  {{ lesson.title }}
                                </p>
                                <div class="flex items-center gap-3 text-xs text-gray-500 mt-1">
                                  <span class="flex items-center gap-1">
                                    <!-- Dynamic Icon based on type -->
                                    <svg
                                      class="w-4 h-4"
                                      fill="none"
                                      stroke="currentColor"
                                      viewBox="0 0 24 24"
                                    >
                                      <!-- Use getTypeIcon/getLessonIcon -->
                                      <!-- Simplified for this view, assumes video by default or logic in TS -->
                                      <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="1.5"
                                        d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                                      />
                                      <path
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                        stroke-width="1.5"
                                        d="M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"
                                      />
                                    </svg>
                                    {{ lesson.duration }}
                                  </span>
                                </div>

                                <!-- Materials (inline with lesson) -->
                                @if (hasRelatedMaterials(lesson)) {
                                  <div class="mt-3 pl-4 border-l-2 border-teal-500/20 space-y-2">
                                    @for (
                                      material of getMaterialsForLesson(lesson.id);
                                      track material.id
                                    ) {
                                      <div
                                        class="flex items-center justify-between group/material py-2 px-3 rounded hover:bg-navy-600/50 transition-colors"
                                      >
                                        <div class="flex items-center gap-2 flex-1 min-w-0">
                                          <span class="text-lg flex-shrink-0">
                                            <svg
                                              class="w-5 h-5"
                                              fill="none"
                                              viewBox="0 0 24 24"
                                              stroke="currentColor"
                                            >
                                              <path
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                stroke-width="1.5"
                                                [attr.d]="getMaterialIcon(material.type)"
                                              />
                                            </svg>
                                          </span>
                                          <span class="text-sm text-gray-300 truncate">{{
                                            material.title
                                          }}</span>
                                          @if (material.fileSize) {
                                            <span class="text-xs text-gray-500 ml-2"
                                              >({{ material.fileSize }})</span
                                            >
                                          }
                                        </div>
                                        <button
                                          (click)="downloadMaterial(material)"
                                          class="opacity-0 group-hover/material:opacity-100 transition-opacity text-teal-400 hover:text-teal-300 text-sm font-semibold flex items-center gap-1"
                                          [attr.aria-label]="'Descargar ' + material.title"
                                        >
                                          <svg
                                            class="w-4 h-4"
                                            fill="none"
                                            stroke="currentColor"
                                            viewBox="0 0 24 24"
                                          >
                                            <path
                                              stroke-linecap="round"
                                              stroke-linejoin="round"
                                              stroke-width="1.5"
                                              d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"
                                            />
                                          </svg>
                                          Descargar
                                        </button>
                                      </div>
                                    }
                                  </div>
                                }
                              </div>
                            </div>
                          </li>
                        }
                      </ul>
                    </div>
                  }
                </article>
              }
            </div>
          }

          @case ('grades') {
            <!-- Grades Tab -->
            <div class="space-y-6 fade-in">
              <!-- Summary Cards -->
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Promedio General -->
                <div
                  class="bg-navy-800/50 p-6 rounded-xl border border-navy-700 relative overflow-hidden"
                >
                  <div class="absolute top-0 right-0 p-4 opacity-10">
                    <svg class="w-24 h-24" fill="currentColor" viewBox="0 0 24 24">
                      <path
                        d="M11.7 2.805a.75.75 0 01.6 0A60.65 60.65 0 0122.83 8.72a.75.75 0 01-.231 1.337 49.949 49.949 0 00-9.902 3.912l-.003.002-.34.18a.75.75 0 01-.707 0A50.009 50.009 0 002.261 8.736.75.75 0 012.029 7.4a60.65 60.65 0 018.96-6.727zM12 20.25c4.35 0 8.096-2.72 9-6.953-3.691 1.066-8.868 1.393-12.91.458 1.134 4.07 4.17 6.495 8.1 6.495z"
                      />
                    </svg>
                  </div>
                  <h3 class="text-gray-400 text-sm font-medium uppercase tracking-wider mb-2">
                    Promedio Actual
                  </h3>
                  <div class="flex items-baseline gap-2">
                    <span class="text-4xl font-bold text-white">{{ course.grades?.promedio }}</span>
                    <span class="text-gray-500">/ 20</span>
                  </div>
                  <div class="mt-4 flex items-center gap-2">
                    <div class="flex-1 h-2 bg-navy-900 rounded-full overflow-hidden">
                      <div
                        class="h-full bg-gradient-to-r from-teal-500 to-blue-500 rounded-full"
                        [style.width.%]="(course.grades?.promedio || 0) * 5"
                      ></div>
                    </div>
                  </div>
                </div>

                <!-- Avance -->
                <div
                  class="bg-navy-800/50 p-6 rounded-xl border border-navy-700 relative overflow-hidden"
                >
                  <h3 class="text-gray-400 text-sm font-medium uppercase tracking-wider mb-2">
                    Avance del Curso
                  </h3>
                  <div class="flex items-baseline gap-2">
                    <span class="text-4xl font-bold text-white">{{ course.grades?.avance }}%</span>
                  </div>
                  <p class="text-sm text-gray-400 mt-2">
                    Has completado {{ course.completedModules }} de
                    {{ course.totalModules }} módulos
                  </p>
                </div>

                <!-- Posicionamiento -->
                <div
                  class="bg-navy-800/50 p-6 rounded-xl border border-navy-700 relative overflow-hidden"
                >
                  <h3 class="text-gray-400 text-sm font-medium uppercase tracking-wider mb-2">
                    Ranking
                  </h3>
                  <div class="flex items-baseline gap-2">
                    <span class="text-4xl font-bold text-yellow-500"
                      >#{{ course.grades?.posicionamiento }}</span
                    >
                    <span class="text-gray-500">de {{ course.grades?.totalEstudiantes }}</span>
                  </div>
                  <p class="text-sm text-gray-400 mt-2">Top 10% de la clase</p>
                </div>
              </div>

              <!-- Grades Table -->
              <div class="bg-navy-800/50 rounded-xl border border-navy-700 overflow-hidden">
                <div class="p-6 border-b border-navy-700">
                  <h3 class="text-lg font-semibold text-white">Detalle de Evaluaciones</h3>
                </div>
                <div class="overflow-x-auto">
                  <table class="w-full text-left">
                    <thead>
                      <tr class="bg-navy-900/50 text-gray-400 text-sm">
                        <th class="px-6 py-4 font-medium">Actividad</th>
                        <th class="px-6 py-4 font-medium text-center">Peso</th>
                        <th class="px-6 py-4 font-medium text-center">Estado</th>
                        <th class="px-6 py-4 font-medium text-right">Calificación</th>
                      </tr>
                    </thead>
                    <tbody class="divide-y divide-navy-700/50">
                      @for (evaluacion of course.grades?.evaluaciones; track evaluacion.actividad) {
                        <tr class="hover:bg-white/5 transition-colors">
                          <td class="px-6 py-4">
                            <span class="text-gray-200 font-medium block">{{
                              evaluacion.actividad
                            }}</span>
                          </td>
                          <td class="px-6 py-4 text-center text-gray-400">
                            {{ evaluacion.peso }}%
                          </td>
                          <td class="px-6 py-4 text-center">
                            <span
                              class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium"
                              [ngClass]="getEstadoBadge(evaluacion.estado)"
                            >
                              <span class="w-1.5 h-1.5 rounded-full bg-current"></span>
                              {{ evaluacion.estado }}
                            </span>
                          </td>
                          <td class="px-6 py-4 text-right">
                            <span
                              class="font-bold text-lg"
                              [ngClass]="getPromedioColor(evaluacion.nota || 0)"
                            >
                              {{ getNotaDisplay(evaluacion.nota || 0, evaluacion.estado) }}
                            </span>
                          </td>
                        </tr>
                      }
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          }
        }
      </div>

      <!-- Right Column: Sidebar (4 cols) -->
      <aside class="col-span-12 lg:col-span-4 space-y-8">
        <!-- Progress Card -->
        <div class="gradient-border-card p-6">
          <h3 class="text-lg font-semibold text-white mb-4">Tu Progreso</h3>
          <!-- Circular Progress -->
          <div class="relative w-32 h-32 mx-auto mb-6">
            <svg class="w-full h-full transform -rotate-90">
              <circle
                cx="64"
                cy="64"
                r="56"
                stroke="currentColor"
                stroke-width="12"
                class="text-navy-700"
                fill="none"
              />
              <circle
                cx="64"
                cy="64"
                r="56"
                stroke="currentColor"
                stroke-width="12"
                class="text-teal-500 transition-all duration-1000 ease-out"
                fill="none"
                stroke-dasharray="351.86"
                [attr.stroke-dashoffset]="351.86 - (351.86 * (course.progress || 0)) / 100"
                stroke-linecap="round"
              />
            </svg>
            <div class="absolute inset-0 flex items-center justify-center">
              <span class="text-2xl font-bold text-white">{{ course.progress }}%</span>
            </div>
          </div>

          <div class="space-y-4">
            <div class="flex justify-between text-sm">
              <span class="text-gray-400">Completado</span>
              <span class="text-white"
                >{{ course.completedModules }}/{{ course.totalModules }} Módulos</span
              >
            </div>
            <div class="flex justify-between text-sm">
              <span class="text-gray-400">Tiempo restante</span>
              <span class="text-white">~45 horas</span>
            </div>
          </div>
        </div>

        <!-- Instructor Card -->
        <div class="bg-navy-800/50 p-6 rounded-xl border border-navy-700">
          <h3 class="text-lg font-semibold text-white mb-4">Instructor</h3>
          <div class="flex items-center gap-4 mb-4">
            <img
              [src]="course.instructor.avatar"
              alt="Instructor"
              class="w-16 h-16 rounded-full border-2 border-teal-500"
            />
            <div>
              <p class="font-bold text-white">{{ course.instructor.name }}</p>
              <p class="text-xs text-teal-400 uppercase tracking-wider font-semibold">
                {{ course.instructor.title }}
              </p>
            </div>
          </div>
          <p class="text-sm text-gray-400 mb-4 line-clamp-3">
            {{ course.instructor.bio }}
          </p>
          <div class="flex gap-2">
            @if (course.instructor.socialLinks.twitter) {
              <a
                [href]="course.instructor.socialLinks.twitter"
                target="_blank"
                class="p-2 bg-navy-700 rounded-lg hover:bg-teal-500/20 hover:text-teal-400 transition-colors"
              >
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"
                  ></path>
                </svg>
              </a>
            }
            @if (course.instructor.socialLinks.linkedin) {
              <a
                [href]="course.instructor.socialLinks.linkedin"
                target="_blank"
                class="p-2 bg-navy-700 rounded-lg hover:bg-blue-500/20 hover:text-blue-400 transition-colors"
              >
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z"
                  ></path>
                  <circle cx="4" cy="4" r="2"></circle>
                </svg>
              </a>
            }
            @if (course.instructor.socialLinks.website) {
              <a
                [href]="course.instructor.socialLinks.website"
                target="_blank"
                class="p-2 bg-navy-700 rounded-lg hover:bg-purple-500/20 hover:text-purple-400 transition-colors"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"
                  ></path>
                </svg>
              </a>
            }
          </div>
        </div>

        <!-- Upcoming Assignments -->
        <div class="bg-navy-800/50 p-6 rounded-xl border border-navy-700">
          <h3 class="text-lg font-semibold text-white mb-4 flex items-center justify-between">
            Próximas Tareas
            <span class="text-xs bg-red-500/20 text-red-400 px-2 py-1 rounded-full"
              >2 pendientes</span
            >
          </h3>
          <div class="space-y-3">
            @for (assignment of upcomingAssignments; track assignment.id) {
              <div
                class="flex items-center gap-3 p-3 bg-navy-900/50 rounded-lg border border-navy-700/50 hover:border-teal-500/30 transition-colors group cursor-pointer"
              >
                <div
                  class="flex-shrink-0 w-12 h-12 bg-navy-800 rounded-lg flex flex-col items-center justify-center border border-navy-700"
                >
                  <span class="text-xs font-bold text-gray-400 uppercase">{{
                    assignment.mes
                  }}</span>
                  <span class="text-lg font-bold text-white">{{ assignment.dia }}</span>
                </div>
                <div>
                  <h4
                    class="text-sm font-semibold text-gray-200 group-hover:text-teal-400 transition-colors"
                  >
                    {{ assignment.titulo }}
                  </h4>
                  <p class="text-xs text-gray-500 mt-0.5 line-clamp-1">Vence en 2 días</p>
                </div>
              </div>
            }
          </div>
        </div>
      </aside>
    </main>
  } @else {
    <!-- Skeleton Loading State -->
    <div class="animate-pulse">
      <div class="h-64 bg-gray-800"></div>
      <div class="container mx-auto px-4 py-8 grid grid-cols-12 gap-8">
        <div class="col-span-12 lg:col-span-8 space-y-8">
          <div class="h-10 w-full bg-gray-800 rounded-xl"></div>
          <div class="h-40 bg-gray-800 rounded-xl"></div>
          <div class="h-40 bg-gray-800 rounded-xl"></div>
        </div>
        <div class="col-span-12 lg:col-span-4 space-y-8">
          <div class="h-64 bg-gray-800 rounded-xl"></div>
          <div class="h-40 bg-gray-800 rounded-xl"></div>
        </div>
      </div>
    </div>
  }
</div>
